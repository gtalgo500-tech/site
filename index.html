<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<title>GTAlgo Portfolio Engine - Prop Firm Edition</title>
<style>
:root {
    --bg: #000000;
    --glass: rgba(255, 255, 255, 0.05);
    --glass-hover: rgba(255, 255, 255, 0.08);
    --border: rgba(255, 255, 255, 0.12);
    --text-primary: #f5f5f7;
    --text-secondary: #86868b;
    --accent: #0071e3;
    --accent-glow: rgba(0, 113, 227, 0.3);
    --green: #10b981;
    --yellow: #f59e0b;
    --red: #ef4444;
    --orange: #f97316;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body { 
    background: var(--bg); 
    color: var(--text-primary); 
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", sans-serif;
    line-height: 1.6;
    overflow-x: hidden;
}

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: 
        linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
    background-size: 50px 50px;
    animation: gridMove 20s linear infinite;
    pointer-events: none;
    z-index: 0;
}

@keyframes gridMove {
    0% { transform: translate(0, 0); }
    100% { transform: translate(50px, 50px); }
}

.container{
    position:relative;
    z-index:1;
    max-width:1200px;
    margin:80px auto;
    padding:40px;
}

.header{
    text-align:center;
    margin-bottom:40px;
}

.logo{
    font-size:28px;
    font-weight:700;
    letter-spacing:1px;
}

.subtitle{
    color:var(--text-secondary);
    font-size:14px;
}

.glass{
    background:var(--glass);
    backdrop-filter: blur(40px);
    border:1px solid var(--border);
    border-radius:20px;
    padding:25px;
    box-shadow:0 0 40px rgba(0,113,227,0.08);
    margin-bottom:20px;
}

.grid{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:20px;
    margin-bottom:25px;
}

label{
    font-size:12px;
    color:var(--text-secondary);
    font-weight:500;
}

input,select{
    width:100%;
    margin-top:10px;
    padding:14px;
    border-radius:12px;
    background:rgba(0,0,0,0.6);
    border:1px solid var(--border);
    color:var(--text-primary);
    font-size:14px;
}

input:focus,select:focus{outline:none;border-color:var(--accent)}

.btn{
    width:100%;
    padding:16px;
    border-radius:14px;
    border:1px solid var(--border);
    background:linear-gradient(180deg, rgba(0,113,227,0.25), rgba(0,113,227,0.05));
    color:var(--text-primary);
    font-weight:600;
    cursor:pointer;
    box-shadow:0 0 25px var(--accent-glow);
    transition:all 0.2s;
}

.btn:hover{
    background:linear-gradient(180deg, rgba(0,113,227,0.35), rgba(0,113,227,0.1));
    transform:translateY(-1px);
}

.prop-toggle{
    display:flex;
    align-items:center;
    gap:12px;
    padding:18px;
    background:rgba(249,115,22,0.1);
    border:1px solid rgba(249,115,22,0.3);
    border-radius:14px;
    margin-bottom:20px;
}

.prop-toggle input[type="checkbox"]{
    width:22px;
    height:22px;
    margin:0;
    cursor:pointer;
}

.prop-toggle label{
    margin:0;
    font-size:14px;
    font-weight:600;
    color:var(--orange);
    cursor:pointer;
}

.prop-badge{
    background:rgba(249,115,22,0.2);
    color:var(--orange);
    padding:4px 10px;
    border-radius:6px;
    font-size:11px;
    font-weight:700;
    letter-spacing:0.5px;
}

.table-wrap{
    margin-top:30px;
    background:var(--glass);
    border:1px solid var(--border);
    border-radius:18px;
    overflow:hidden;
}

table{
    width:100%;
    border-collapse:collapse;
    font-size:13px;
}

th{
    background:rgba(0,0,0,0.6);
    color:var(--text-secondary);
    padding:14px;
    font-weight:600;
}

td{
    padding:12px;
    text-align:center;
    border-bottom:1px solid rgba(255,255,255,0.05);
}

tr:hover{background:var(--glass-hover)}

.ok{color:var(--green);font-weight:600}
.bad{color:var(--red);font-weight:600}
.warning{color:var(--orange);font-weight:600}

.info-box{
    padding:16px;
    border-radius:12px;
    margin-top:15px;
    font-size:13px;
    line-height:1.6;
}

.info-box.green{
    background:rgba(16,185,129,0.1);
    border:1px solid rgba(16,185,129,0.3);
    color:var(--green);
}

.info-box.red{
    background:rgba(239,68,68,0.1);
    border:1px solid rgba(239,68,68,0.3);
    color:var(--red);
}

.info-box.orange{
    background:rgba(249,115,22,0.1);
    border:1px solid rgba(249,115,22,0.3);
    color:var(--orange);
}

.stats-grid{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:15px;
    margin-top:20px;
}

.stat-card{
    background:rgba(0,0,0,0.4);
    border:1px solid var(--border);
    border-radius:12px;
    padding:15px;
    text-align:center;
}

.stat-label{
    font-size:11px;
    color:var(--text-secondary);
    margin-bottom:6px;
}

.stat-value{
    font-size:20px;
    font-weight:700;
    color:var(--text-primary);
}

.footer{
    margin-top:20px;
    text-align:center;
    font-size:12px;
    color:var(--text-secondary);
}

@media (max-width: 768px) {
    .container {
        margin: 40px 15px;
        padding: 20px;
    }

    .grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }

    .stats-grid{
        grid-template-columns: repeat(2,1fr);
    }

    .btn {
        padding: 16px;
        font-size: 14px;
    }

    input, select {
        padding: 12px;
        font-size: 14px;
    }

    table {
        font-size: 11px;
        display: block;
        overflow-x: auto;
    }
}   
</style>
</head>
<body>

<div class="container">

    <div class="header">
        <div class="logo">GTAlgo Portfolio Engine</div>
        <div class="subtitle">Multi‚ÄëStrategy Automated Allocation System</div>
    </div>

    <div class="glass">
        <!-- PROP FIRM TOGGLE -->
        <div class="prop-toggle">
            <input type="checkbox" id="propFirmMode" onchange="updateRiskProfiles()">
            <label for="propFirmMode">üõ°Ô∏è PROP FIRM MODE (5% Daily Limit Protection)</label>
            <span class="prop-badge">RECOMMENDED</span>
        </div>

        <div class="grid">
            <div>
                <label>Account Balance ($)</label>
                <input type="number" id="balance" placeholder="e.g. 5000" value="10000">
            </div>

            <div>
                <label>Risk Profile <span id="riskLabel"></span></label>
                <select id="risk" onchange="updateLabel()">
                    <option value="0.5">Low Risk</option>
                    <option value="1" selected>Normal Risk</option>
                    <option value="1.5">Aggressive</option>
                </select>
            </div>

            <div style="display:flex;align-items:flex-end">
                <button class="btn" onclick="calc()">Calculate Portfolio Allocation</button>
            </div>
        </div>

        <div class="table-wrap" id="result"></div>
        <div id="statsBox"></div>
    </div>

    <div class="footer">
        ‚ö†Ô∏è Prop Firm Mode reduces lot sizes by 3-5x to respect 5% daily loss limit when running multiple strategies simultaneously.<br>
        Historical performance does not guarantee future results.
    </div>

</div>

<script>
const refBalance = 10000;

const portfolio = [
  {name:"GT-NovaPro US500", lot:5, min:0.1, group:"NovaPro"},
  {name:"GT-NovaPro US30", lot:0.5, min:0.1, group:"NovaPro"},

  {name:"GT-ApexPro XAU M15", lot:0.1, min:0.01, group:"ApexPro"},
  {name:"GT-ApexPro XAU H1", lot:0.13, min:0.01, group:"ApexPro"},
  {name:"GT-ApexPro USDJPY", lot:0.7, min:0.01, group:"ApexPro"},
  {name:"GT-ApexPro US100", lot:1.3, min:0.1, group:"ApexPro"},

  {name:"GT-StormX US30", lot:0.4, min:0.1, group:"StormX"},
  {name:"GT-StormX GER40", lot:1.3, min:0.1, group:"StormX"},
  {name:"GT-StormX US100", lot:1.3, min:0.1, group:"StormX"},

  {name:"GT-TitanX US500", lot:4, min:0.1, group:"TitanX"},

  {name:"GT-VectorPro XAU", lot:0.06, min:0.01, group:"VectorPro"},
  {name:"GT-VectorPro BTC", lot:0.1, min:0.01, group:"VectorPro"},
  {name:"GT-VectorPro NAS100", lot:1, min:0.1, group:"VectorPro"},
  {name:"GT-VectorPro USDJPY", lot:0.4, min:0.01, group:"VectorPro"}
];

function updateRiskProfiles(){
  const propMode = document.getElementById('propFirmMode').checked;
  const riskSelect = document.getElementById('risk');
  
  if(propMode){
    riskSelect.innerHTML = `
      <option value="0.25">Conservative (Prop Safe)</option>
      <option value="0.33" selected>Balanced (Prop Safe)</option>
      <option value="0.4">Aggressive (Prop Safe)</option>
    `;
  } else {
    riskSelect.innerHTML = `
      <option value="0.5">Low Risk</option>
      <option value="1" selected>Normal Risk</option>
      <option value="1.5">Aggressive</option>
    `;
  }
  updateLabel();
}

function updateLabel(){
  const propMode = document.getElementById('propFirmMode').checked;
  const risk = parseFloat(document.getElementById('risk').value);
  const label = document.getElementById('riskLabel');
  
  if(propMode){
    const divider = (1 / risk).toFixed(1);
    label.textContent = `(${divider}x safer)`;
    label.style.color = 'var(--orange)';
  } else {
    label.textContent = '';
  }
}

function calc(){
  const balance = parseFloat(document.getElementById('balance').value);
  const risk = parseFloat(document.getElementById('risk').value);
  const propMode = document.getElementById('propFirmMode').checked;
  
  if(!balance || balance<=0){
    alert('Enter valid balance');
    return;
  }

  // PROP FIRM: reduce lot size cu mult mai mult
  const propDivider = propMode ? 3.5 : 1; // 3.5x mai mic in prop firm mode
  const scale = (balance / refBalance) * risk / propDivider;

  let html = `<table>
    <tr>
      <th>Strategy</th>
      <th>Original Lot</th>
      <th>${propMode ? 'Prop Firm Lot' : 'Calculated Lot'}</th>
      <th>Status</th>
    </tr>`;
  
  let valid = true;
  let totalOriginal = 0;
  let totalAdjusted = 0;
  let belowMin = 0;

  portfolio.forEach(p=>{
    let lot = p.lot * scale;
    let status = 'OK';
    let cls = 'ok';

    totalOriginal += p.lot;
    
    if(lot < p.min){
      status = 'BELOW MIN';
      cls = 'bad';
      valid = false;
      belowMin++;
    } else {
      totalAdjusted += lot;
    }

    html += `<tr>
      <td style="text-align:left">${p.name}</td>
      <td>${p.lot.toFixed(2)}</td>
      <td><strong>${lot.toFixed(3)}</strong></td>
      <td class="${cls}">${status}</td>
    </tr>`;
  });

  html += '</table>';

  // INFO BOXES
  let infoHtml = '';
  
  if(!valid){
    infoHtml += `<div class="info-box red">
      ‚ö†Ô∏è <strong>Account too small:</strong> ${belowMin} strategies below minimum lot size.<br>
      ${propMode ? 'Recommended minimum for Prop Firm Mode: <strong>$15,000</strong>' : 'Recommended minimum: <strong>$5,000</strong>'}
    </div>`;
  } else {
    const reduction = ((1 - (scale / (balance / refBalance * risk))) * 100).toFixed(0);
    infoHtml += `<div class="info-box green">
      ‚úÖ <strong>Portfolio allocation valid</strong><br>
      ${propMode ? `Lot sizes reduced by ${reduction}% for prop firm safety. All strategies can run simultaneously without hitting 5% daily limit.` : 'All strategies operational with standard risk parameters.'}
    </div>`;
  }

  if(propMode && balance < 15000){
    infoHtml += `<div class="info-box orange">
      ‚ö° <strong>Prop Firm Warning:</strong> Running ${portfolio.length} strategies on $${balance.toLocaleString()} account increases risk.<br>
      Consider: (1) Increasing account size, (2) Running fewer strategies, or (3) Using Conservative profile.
    </div>`;
  }

  // STATS
  const avgLot = valid ? (totalAdjusted / portfolio.length).toFixed(3) : 0;
  const totalReduction = propMode ? ((totalOriginal - totalAdjusted) / totalOriginal * 100).toFixed(0) : 0;
  
  infoHtml += `<div class="stats-grid">
    <div class="stat-card">
      <div class="stat-label">Active Strategies</div>
      <div class="stat-value">${portfolio.length}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Avg Lot Size</div>
      <div class="stat-value">${avgLot}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Risk Multiplier</div>
      <div class="stat-value">${risk}x</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">${propMode ? 'Lot Reduction' : 'Mode'}</div>
      <div class="stat-value">${propMode ? totalReduction + '%' : 'Standard'}</div>
    </div>
  </div>`;

  document.getElementById('result').innerHTML = html;
  document.getElementById('statsBox').innerHTML = infoHtml;
}

// Initialize
updateRiskProfiles();
updateLabel();
</script>
</body>
</html>
